#!/bin/bash

# Define a resusable function
remove_Profile() {
targetProfileName="$1"
## Get UUID of requested Configuration Profile
profileUUID=`profiles -Lv | grep "$targetProfileName" -4 | awk -F": " '/attribute: profileIdentifier/{print $NF}'`

## Remove said profile, identified by UUID
if [[ $profileUUID ]]; then
    profiles -R -p $profileUUID
else
    echo "No Profile Found"
fi
#sleep 5
}

# Use parameters passed to the script
# Ignore first three parameters for compatibility with Capser MDM, comment out for other use cases
shift;shift;shift

# Iterate over remainder
while test ${#} -gt 0
do
  echo -n "Removing profile "$1"... "; remove_Profile "$1"
  shift
done
exit 0
